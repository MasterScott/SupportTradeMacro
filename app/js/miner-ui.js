var MinerUI=function(t,e){this.miner=t,this.elements=e,this.intervalUpdateStats=0,this.intervalDrawGraph=0,this.intervalUpdateUSD=0,this.ctx=this.elements.canvas.getContext("2d"),this.elements.startButton.addEventListener("click",this.start.bind(this)),this.elements.stopButton.addEventListener("click",this.stop.bind(this)),this.elements.threadsAdd.addEventListener("click",this.addThread.bind(this)),this.elements.threadsRemove.addEventListener("click",this.removeThread.bind(this)),this.stats=[];for(var s=0;s<300;0,s+=5)this.stats.push({hashes:0,accepted:0});this.acceptedHashes=0,this.accumulatedUSD=0,this.miner&&(this.didAcceptHash=!1,this.miner.on("accepted",function(){this.didAcceptHash=!0}.bind(this)))};MinerUI.prototype.start=function(t){return t.preventDefault(),this.miner?(this.miner.start(CoinHive.FORCE_MULTI_TAB),this.elements.container.classList.add("running"),this.elements.container.classList.remove("stopped"),this.intervalUpdateStats=setInterval(this.updateStats.bind(this),50),this.intervalDrawGraph=setInterval(this.drawGraph.bind(this),500),this.intervalUpdateUSD=setInterval(this.getUSD.bind(this),6e4),this.elements.threads.textContent=this.miner.getNumThreads(),!1):(this.elements.blkWarn.style.display="block",this.elements.startButton.style.display="none",!1)},MinerUI.prototype.stop=function(t){return this.miner.stop(),this.elements.hashesPerSecond.textContent=0,this.elements.container.classList.remove("running"),this.elements.container.classList.add("stopped"),clearInterval(this.intervalUpdateStats),clearInterval(this.intervalDrawGraph),t.preventDefault(),!1},MinerUI.prototype.addThread=function(t){return this.miner.setNumThreads(this.miner.getNumThreads()+1),this.elements.threads.textContent=this.miner.getNumThreads(),t.preventDefault(),!1},MinerUI.prototype.removeThread=function(t){return this.miner.setNumThreads(Math.max(0,this.miner.getNumThreads()-1)),this.elements.threads.textContent=this.miner.getNumThreads(),t.preventDefault(),!1},MinerUI.prototype.updateStats=function(){this.elements.hashesPerSecond.textContent=this.miner.getHashesPerSecond().toFixed(1),this.elements.hashesTotal.textContent=this.miner.getTotalHashes(!0),this.elements.hashesAccepted.textContent=this.miner.getAcceptedHashes(!0)},MinerUI.prototype.drawGraph=function(){this.elements.canvas.offsetWidth!==this.elements.canvas.width&&(this.elements.canvas.width=this.elements.canvas.offsetWidth,this.elements.canvas.height=this.elements.canvas.offsetHeight);var t=this.elements.canvas.width,e=this.elements.canvas.height,s=this.stats.shift();this.stats[this.stats.length-1];s.hashes=this.miner.getHashesPerSecond(),s.accepted=this.didAcceptHash,this.didAcceptHash=!1,this.stats.push(s);for(var i=0,a=0;a<this.stats.length;a++){var n=this.stats[a].hashes;n>i&&(i=n)}this.ctx.clearRect(0,0,t,e);for(var a=this.stats.length,h=1;a--;h++){var r=this.stats[a],c=r.hashes/i*(e-16)|0;r.accepted?(this.ctx.fillStyle="#aaa",this.ctx.fillRect(t-10*h,e-c,9,c)):(this.ctx.fillStyle="#ccc",this.ctx.fillRect(t-10*h,e-c,9,c))}},MinerUI.prototype.getUSD=function(){$.get("https://www.cryptocompare.com/api/data/coinsnapshot/?fsym=XMR&tsym=USD",function(t){var e=t.Data.AggregatedData.Price,s=(t.Data.BlockReward,t.Data.TotalCoinsMined),i=1/(24*(728*t.Data.NetHashesPerSecond/(18446744.07370955-s))*60*60),a=e*(Math.round(acceptedHashes)*i);this.accumulatedUSD=a,this.elements.accumulatedUSD.textContent=a})};